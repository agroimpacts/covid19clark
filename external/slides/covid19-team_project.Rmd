---
title: "Geospatial Analysis with R Final Presentation: COVID-19"
subtitle: By Zoe Maymon and Olivia Landry
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["default", "rladies-fonts", "tamu"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
#Setup
library(ggplot2)
library(tidyverse)
library(COVID19)
library(covid19clark)
data("us_counties")
data("us_cases_daily")
library(devtools)
library(dplyr)
library(stringr)
library(maps)
library(mapdata)
library(ggmap)
library("rnaturalearth")
library("rnaturalearthdata")
library("sf")
```


## COVID-19 Summary

* COVID-19 derives from a coronavirus named SARS-CoV-2 and tends to spread through saliva droplets when a person coughs or through nose discharge when a person sneezes.

* Most people with the virus will experience respiratory illness and recover without hospitalization, but it more seriously affects older adults and people with underlying medical conditions. 

* There are currently over 1 million confirmed cases in the United States and over 65,000 deaths. 

* In Massachusetts there are over 65,000 confirmed cases and over 3,000 deaths.

---
## COVID19clark Package
* Our project was based on the "COVID19clark" R package, primarily assembled and developed by Dr. Lyndon Estes.

* The package is adapted from Rami Krispin's "coronavirus" R package 
(https://github.com/RamiKrispin/coronavirus) and data is gathered from the Johns 
Hopkins University COVID-19 data repository 
(https://github.com/CSSEGISandData/COVID-19/).
  * Krispin's package was used to create this data dashboard of COVID-19 cases: 
  https://ramikrispin.github.io/coronavirus_dashboard/

* The COVID19clark package summarizes the COVID-19 data from JHU, maps its 
severity in the northeastern United States, and graphs the amount of cases and deaths within the area.


---
## Data Visualizations

#### Chart 1
```{r echo=FALSE, message=FALSE, fig.align='center', fig.width=11.5, fig.height= 6.5}

 ggplot() + geom_histogram(data = us_cases_daily$county %>% 
                              filter(.$cases > 0),
             aes(x = x, fill = "cases"), color = "white") + 
  geom_histogram(data =us_cases_daily$county %>% filter(.$deaths > 0), 
             aes(x = x, fill = "deaths"), color = "white") + 
    labs(title="Histogram Showing U.S. Cases and Deaths", 
         x = "Longitude", y = "Cases/Deaths") +
  theme(plot.title = element_text(hjust = 0.5)) + theme(legend.title = element_blank())

```


---
#### Chart 2

```{r echo=FALSE, message=FALSE, fig.align='center', fig.width=11.5}

state_cases <- us_cases_daily$state %>% group_by(state1) %>% select(cases) %>% 
  summarise(maxcases = max(cases))
 barplot(state_cases$maxcases, main = "Number of COVID-19 Cases by State", 
         xlab = "U.S. States and Territories", ylab = "Number of Cases", 
         names.arg = c(1:52), col = "purple")

```


---
#### Chart 3



```{r echo=FALSE, message=FALSE, fig.align='center', fig.width=11.5}

state_deaths <- us_cases_daily$state %>% group_by(state1) %>% 
    select(deaths) %>% summarise(maxdeaths = max(deaths)) 
  barplot(state_deaths$maxdeaths, main = "Number of COVID-19 Deaths by State", 
          xlab = "U.S. States and Territories", ylab = "Number of Deaths", 
          names.arg = c(1:52), col = "purple")

```


---

## Shiny

#### Summary

* Shiny is a free R package that allows users to create interactive web 
applications 

* The current version of Shiny is 1.4.0.2

* No Javascript is required for usage, and it can only use web mapping platforms
such as Leaflet and Mapbox

* Can be downloaded using CRAN or Github

* Can be published onto R Studio's designated Shiny App web server and can be 
treated as a web application

---

## Shiny 

#### Setup

To download using CRAN, use the following code chunk:

```{r eval=FALSE}

install.packages("shiny")
 
```

To download from Github, use the following code chunk:

```{r eval=FALSE}

devtools::install_github("rstudio/shiny")
 
```
---

## Shiny

#### Layout

To create a basic app with Shiny use the following code chunk (example):

```{r eval = FALSE}
library(shiny)
# Define UI for app that draws a histogram ----
ui <- fluidPage(
  # App title ----
  titlePanel("Hello Shiny!"),
  # Sidebar layout with input and output definitions ----
  sidebarLayout(
    # Sidebar panel for inputs ----
    sidebarPanel(
      # Input: Slider for the number of bins ----
      sliderInput(inputId = "bins",
                  label = "Number of bins:",
                  min = 1,
                  max = 50,
                  value = 30)
    ),
    # Main panel for displaying outputs ----
    mainPanel(
      # Output: Histogram ----
      plotOutput(outputId = "distPlot")
    )
  )
)
```

---

```{r eval = FALSE}
# Define server logic required to draw a histogram ----
server <- function(input, output) {
  output$distPlot <- renderPlot({

    x    <- faithful$waiting
    bins <- seq(min(x), max(x), length.out = input$bins + 1)

    hist(x, breaks = bins, col = "#75AADB", border = "white",
         xlab = "Waiting time to next eruption (in mins)",
         main = "Histogram of waiting times")
    })
}
# Create Shiny app ----
shinyApp(ui = ui, server = server)

```

* This example Shiny app creates an interactive page where you can change the
slider for how many bins there are in the random normal distribution bar chart.

* The app consists of a UI function and a Server function.
  * "The user interface (ui) object controls the layout and appearance of your 
  app." (from https://shiny.rstudio.com/tutorial/written-tutorial/lesson1/)
  * "The server function contains the instructions that your computer needs to 
  build your app." (from https://shiny.rstudio.com/tutorial/written-tutorial/lesson1/)
  * "Finally the shinyApp function creates Shiny app objects from an explicit 
  UI/server pair."  (from https://shiny.rstudio.com/tutorial/written-tutorial/lesson1/)

---

## Plotly

#### Summary

* Plotly is a free R package that can be used to create interactive maps with 
ggplot2 graphs and custom interfaces using the open source JavaScript graphic 
library (plotly.js).

* The current version of Plotly is 4.9.2.1

* It can use web mapping platforms such as Leaflet and Mapbox

* It can be downloaded using CRAN or Github and uses htmlwidgets to create 
interactive dashboards.


---

## Plotly

#### Setup

To download using CRAN, use the following code chunk:

```{r eval=FALSE}

install.packages("plotly")
 
```


To download from Github, use the following code chunk:

```{r eval=FALSE}

devtools::install_github("ropensci/plotly")
 
```


---

## Plotly

#### Layout


To create a basic chart with Plotly use the following code chunk:


```{r eval=FALSE}

library(plotly)
fig <- plot_ly(us_cases_daily, x = ~x, color = ~state)
fig

```

* The library() function loads the Plotly package. 

* The first argument in the plot_ly() function will be your data in data frame 
form, the second argument will be the x coordinate/longitude of your data, and 
the third argumet will change the color of your chart based on state names in 
the data frame. 

* Other options not shown in the code chunk above, include changing the y 
coordinate/latitude of your data, changing the color of your chart (using colorscale=), changing the type of your chart (using type=), adding hover info to your chart (using hoverinfo=), among others.  

---

## Concluding Remarks

* Both the Shiny and Plotly aspects of our poject provide accurate depictions of cases and deaths in the United States but could be made even more successful with additions of interactive dropdown menus and charts.

* As more and more data is being created each day, more aspects can be added to this project including number of current COVID-19 tests in the United States.

* This work is highly important and we hope to both be a part of continuing this work into the future. 
